
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="sidebar">
    <div class="menu">ðŸ§¾ Admin Dashboard</div>
    <button onclick="logout()" style="margin-top: 10px;">Logout</button>
  </div>

  <div class="card" id="dashboard">
    <h2>Dashboard - User Management</h2>
    <div id="userList"></div>

    <h3>Tambah User Baru</h3>
    <input type="text" id="newUser" placeholder="Username">
    <input type="text" id="newPass" placeholder="Password">
    <select id="newRole">
      <option value="user">User</option>
      <option value="admin">Admin</option>
    </select>
    <input type="number" id="expire" placeholder="Expired (timestamp)">
    <button onclick="addUser()">Tambah</button>
  </div>

  <script>
    const JSONBIN_API = 'https://api.jsonbin.io/v3/b/YOUR_BIN_ID_HERE';
    const JSONBIN_KEY = 'YOUR_SECRET_KEY_HERE';
    let currentData = [];

    function logout() {
      localStorage.clear();
      window.location.href = "index.html";
    }

    async function fetchUsers() {
      const res = await fetch(JSONBIN_API, {
        headers: { 'X-Master-Key': JSONBIN_KEY }
      });
      const data = await res.json();
      currentData = data.record.users;

      const container = document.getElementById('userList');
      container.innerHTML = currentData.map(u => `
        <div>
          <b>${u.username}</b> (${u.role}) - Exp: ${u.expired}
          <button onclick="deleteUser('${u.username}')">Hapus</button>
        </div>
      `).join('');
    }

    async function addUser() {
      const user = document.getElementById('newUser').value;
      const pass = document.getElementById('newPass').value;
      const role = document.getElementById('newRole').value;
      const expired = document.getElementById('expire').value;

      currentData.push({ username: user, password: pass, role, expired });

      await fetch(JSONBIN_API, {
        method: 'PUT',
        headers: {
          'X-Master-Key': JSONBIN_KEY,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ users: currentData })
      });

      alert('User ditambahkan!');
      fetchUsers();
    }

    async function deleteUser(user) {
      currentData = currentData.filter(u => u.username !== user);
      await fetch(JSONBIN_API, {
        method: 'PUT',
        headers: {
          'X-Master-Key': JSONBIN_KEY,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ users: currentData })
      });
      fetchUsers();
    }

    fetchUsers();
  </script>
</body>
</html>
